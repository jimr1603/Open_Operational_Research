source('~/bin/R/Newton_fractal/src/newton_iterate.R')
points %>%
mutate(last_point = round(last_point,0)) %>%
filter(last_point^4==1) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
library("tidyverse")
f <- function(z){
z^3-1
}
df <- function(z){
3*z^2
}
Newton_iterate <- function(z_n){
z_n-f(z_n)/df(z_n)
}
points <- crossing(real = seq(-2,2,by=0.01), imaginary=real) %>%
mutate(original_point = complex(real = real, imaginary = imaginary)) %>%
mutate(last_point = original_point)
loops <- 100
pb <- progress_estimated(loops)
for(i in 1:loops){
pb$tick()$print()
points <- points %>%
mutate(last_point = Newton_iterate(last_point))
}
points %>%
mutate(last_point = round(last_point,0)) %>%
filter(f(last_point)==0) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
library("tidyverse")
f <- function(z){
z^3-1
}
df <- function(z){
3*z^2
}
Newton_iterate <- function(z_n){
z_n-f(z_n)/df(z_n)
}
points <- crossing(real = seq(-2,2,by=0.01), imaginary=real) %>%
mutate(original_point = complex(real = real, imaginary = imaginary)) %>%
mutate(last_point = original_point)
loops <- 100
pb <- progress_estimated(loops)
for(i in 1:loops){
pb$tick()$print()
points <- points %>%
mutate(last_point = Newton_iterate(last_point))
}
points %>%
mutate(last_point = round(last_point,1)) %>%
filter(f(last_point)==0) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
points %>%
filter(round(f(last_point),1)==0) %>%
mutate(last_point = round(last_point,1)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
points %>%
filter(round(f(last_point),1)==0) %>%
mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
library("tidyverse")
f <- function(z){
z^5-1
}
df <- function(z){
5*z^4
}
Newton_iterate <- function(z_n){
z_n-f(z_n)/df(z_n)
}
points <- crossing(real = seq(-2,2,by=0.01), imaginary=real) %>%
mutate(original_point = complex(real = real, imaginary = imaginary)) %>%
mutate(last_point = original_point)
loops <- 100
pb <- progress_estimated(loops)
for(i in 1:loops){
pb$tick()$print()
points <- points %>%
mutate(last_point = Newton_iterate(last_point))
}
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE)
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + ggthemes::theme_few()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_color_calc()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_fill_calc()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_fill_economist()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_fill_few()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_fill_excel()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_fill_excel_new()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_fill_fivethirtyeight()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + ggthemes::scale_fill_wsj()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + scale_fill_hue()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + scale_fill_viridis_d()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + scale_fill_brewer()
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + scale_fill_brewer(type = "qal")
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + scale_fill_brewer(type = "qual")
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + scale_fill_brewer(type = "div")
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal() + scale_fill_brewer(type = "qual")
library("tidyverse")
f <- function(z){
z^20-1
}
df <- function(z){
20*z^19
}
Newton_iterate <- function(z_n){
z_n-f(z_n)/df(z_n)
}
points <- crossing(real = seq(-2,2,by=0.01), imaginary=real) %>%
mutate(original_point = complex(real = real, imaginary = imaginary)) %>%
mutate(last_point = original_point)
loops <- 100
pb <- progress_estimated(loops)
for(i in 1:loops){
pb$tick()$print()
points <- points %>%
mutate(last_point = Newton_iterate(last_point))
}
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal()
rm(list=ls())
library("tidyverse")
f <- function(z){
z^20-1
}
df <- function(z){
20*z^19
}
Newton_iterate <- function(z_n){
z_n-f(z_n)/df(z_n)
}
points <- crossing(real = seq(-1.2,1.2,by=0.001), imaginary=real) %>%
mutate(original_point = complex(real = real, imaginary = imaginary)) %>%
mutate(last_point = original_point)
loops <- 100
pb <- progress_estimated(loops)
for(i in 1:loops){
pb$tick()$print()
points <- points %>%
mutate(last_point = Newton_iterate(last_point))
}
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal()
library("tidyverse")
f <- function(z){
z^20-1
}
df <- function(z){
20*z^19
}
Newton_iterate <- function(z_n){
z_n-f(z_n)/df(z_n)
}
points <- crossing(real = seq(-1.2,1.2,by=0.001), imaginary=real) %>%
mutate(original_point = complex(real = real, imaginary = imaginary)) %>%
mutate(last_point = original_point)
loops <- 1000
pb <- progress_estimated(loops)
for(i in 1:loops){
pb$tick()$print()
points <- points %>%
mutate(last_point = Newton_iterate(last_point))
}
points %>%
filter(round(f(last_point),1)==0) %>%
#mutate(last_point = round(last_point,10)) %>%
ggplot(aes(x=real,y=imaginary,fill=as.factor(last_point))) + geom_raster() +
guides(fill=FALSE) + theme_minimal()
