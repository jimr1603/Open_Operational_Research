ggplot(aes(x = number, y = score)) + geom_point() + geom_line(aes(x = 0:20, y = 0:20)) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added")
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score)) + geom_point() + theme + geom_hline(yintercept = 1) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
)
alias_scores <- read_csv(here::here("static", "data", "Wiki", "names_of_numbers.csv")) %>%
separate(3, as.character(1:100), ",") %>%
gather("key", "name", -Number) %>%
select(-key) %>%
drop_na() %>%
mutate(name = str_extract(name, "[a-zA-Z \\-]+")) %>% # Too many footnotes and references to countries that need dropping
drop_na() %>%
rowwise() %>%
mutate(score = convert_word_to_score(name)) %>%
arrange(Number)
knitr::kable(alias_scores, rownames = F)
alias_scores %>%
filter(Number==score) %>%
knitr::kable()
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score)) + geom_point() + theme + geom_hline(yintercept = 1) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
)
word_to_score <- function(word, modifier = 1) {
# I am terrible at writing vectorised functions.
if (class(modifier) == "list") modifier <- unlist(modifier)
suppressMessages(str_to_lower(word) %>%
str_extract_all("[a-z]") %>%
unlist() %>%
tibble(letters = ., modifier = modifier) %>%
left_join(scores) %>%
summarise(score = sum(score * modifier)) %>%
pull())
}
binary <- list(crossing(0:1))
for (i in 2:12) {
binary <- append(
binary,
list(
crossing(binary[[i - 1]], 0:1)
)
)
}
binary <- map(binary, transpose) %>%
flatten() %>%
tibble(sequence = .) %>%
rowwise() %>%
mutate(length = length(sequence)) %>%
ungroup()
blank_scores <- alias_scores %>%
mutate(name = name %>%
str_to_lower() %>%
str_remove_all("\\W")) %>%
filter(score > Number) %>%
mutate(length = str_length(name)) %>%
left_join(binary) %>%
rowwise() %>%
mutate(score_with_blanks = word_to_score(name, sequence))
blank_scores %>%
select(Number, name, score_with_blanks) %>%
filter(Number == score_with_blanks) %>%
unique() %>%
ungroup() %>%
dplyr::arrange(Number) %>%
knitr::kable()
blankify <- function(word, mask) {
word %>%
str_extract_all("[a-z]") %>%
unlist() %>%
replace(which(mask == 0), "☐") %>%
str_flatten()
}
blank_scores %>%
select(Number, sequence, name, score_with_blanks) %>%
filter(Number == score_with_blanks) %>%
mutate(name_with_blanks = blankify(name, sequence)) %>%
select(name, name_with_blanks,Number) %>%
ungroup() %>%
dplyr::arrange(Number) %>%
knitr::kable()
?collect()
?gather
?spread
blank_scores %>%
select(Number, sequence, name, score_with_blanks) %>%
filter(Number == score_with_blanks) %>%
mutate(name_with_blanks = blankify(name, sequence)) %>%
select(name, name_with_blanks,Number) %>%
group_by(Number) %>%
summarise(name = str_flatten(name, " , "))
blank_scores %>%
select(Number, sequence, name, score_with_blanks) %>%
filter(Number == score_with_blanks) %>%
mutate(name_with_blanks = blankify(name, sequence)) %>%
select(name, name_with_blanks,Number) %>%
group_by(Number) %>%
summarise(name = str_flatten(name, " , ")) %>% View()
blank_scores %>%
select(Number, sequence, name, score_with_blanks) %>%
filter(Number == score_with_blanks) %>%
mutate(name_with_blanks = blankify(name, sequence)) %>%
select(name, name_with_blanks,Number) %>%
group_by(name) %>%
summarise(name_with_blanks = str_flatten(name_with_blanks, " , "))
blank_scores %>%
select(Number, sequence, name, score_with_blanks) %>%
filter(Number == score_with_blanks) %>%
mutate(name_with_blanks = blankify(name, sequence)) %>%
select(name, name_with_blanks,Number) %>%
group_by(name) %>%
summarise(name_with_blanks = str_flatten(name_with_blanks, " , ")) %>% View()
blank_scores %>%
select(Number, sequence, name, score_with_blanks) %>%
filter(Number == score_with_blanks) %>%
mutate(name_with_blanks = blankify(name, sequence)) %>%
select(name, name_with_blanks,Number) %>%
group_by(Number, name) %>%
summarise(name_with_blanks = str_flatten(name_with_blanks, " , ")) %>% View()
blogdown::serve_site()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::serve_site()
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
collapse = TRUE
)
library("tidyverse")
library("DT")
library("plotly")
theme <- ggthemes::theme_few()
scores <- tibble(
letters = letters,
score = c(
1, 3, 3,
2, 1, 4,
2, 4, 1,
8, 5, 1,
3, 1, 1,
3, 10, 1,
1, 1, 1,
4, 4, 8,
4, 10
)
)
convert_word_to_score <- function(word) {
suppressMessages(str_to_lower(word) %>%
str_extract_all("[a-z]") %>%
unlist() %>%
tibble(letters = .) %>%
left_join(scores) %>%
pull(score) %>%
sum())
}
convert_word_to_score("one")
base_scores <- tribble(
~number, ~name,
0, "Zero",
1, "One",
2, "Two",
3, "Three",
4, "Four",
5, "Five",
6, "Six",
7, "Seven",
8, "Eight",
9, "Nine",
10, "Ten",
11, "Eleven",
12, "Twelve",
13, "Thirteen",
14, "Fourteen",
15, "Fifteen",
16, "Sixteen",
17, "Seventeen",
18, "Eighteen",
19, "Nineteen",
20, "Twenty"
) %>%
rowwise() %>%
mutate(score = convert_word_to_score(name))
filter(base_scores, number == score) %>%
knitr::kable()
base_scores %>%
ggplot(aes(x = number, y = score)) + geom_point() + geom_line(aes(x = 0:20, y = 0:20, colour=(number==score))) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added")
base_scores %>%
ggplot(aes(x = number, y = score, colour=(number==score))) + geom_point() + geom_line(aes(x = 0:20, y = 0:20)) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added")
base_scores %>%
ggplot(aes(x = number, y = score, colour=(number==score))) + geom_point() + geom_line(aes(x = 0:20, y = 0:20, colour=TRUE)) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added")
base_scores %>%
ggplot(aes(x = number, y = score, colour=(number==score))) + geom_point() + geom_line(aes(x = 0:20, y = 0:20, colour=TRUE)) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added") + guides(fill=FALSE)
base_scores %>%
ggplot(aes(x = number, y = score, colour=(number==score))) + geom_point() + geom_line(aes(x = 0:20, y = 0:20, colour=TRUE)) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added") + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=(relative_score==1))) + geom_point() + theme + geom_hline(yintercept = 1, colour=TRUE) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=(relative_score==1))) + geom_point() + theme + geom_hline(yintercept = 1) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=(relative_score==1))) + geom_point() + theme + geom_hline(yintercept = 1, aes(colour=TRUE)) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=(relative_score==1))) + geom_point() + theme + geom_line(aes(x=0:20,y=1,colour=TRUE)) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=(relative_score==1))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour=TRUE)) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=sign(relative_score))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour=0)) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=sign(relative_score-1))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour=0)) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=as.ordered(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour=0)) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour=0)) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour="0"")) + labs(
title = "Small numbers score greater than themselves\n
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour="0")) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE)
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour="0")) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE) + ggthemes::scale_colour_few()
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
collapse = TRUE
)
library("tidyverse")
library("DT")
library("plotly")
theme <- ggthemes::theme_few()
scale <- ggthemes::scale_colour_few()
base_scores %>%
ggplot(aes(x = number, y = score, colour=(number==score))) + geom_point() + geom_line(aes(x = 0:20, y = 0:20, colour=TRUE)) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added") + guides(colour=FALSE) + scale
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_hline(yintercept = 1) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
collapse = TRUE
)
library("tidyverse")
library("DT")
library("plotly")
theme <- ggthemes::theme_few()
scale <- ggthemes::scale_colour_few()
scores <- tibble(
letters = letters,
score = c(
1, 3, 3,
2, 1, 4,
2, 4, 1,
8, 5, 1,
3, 1, 1,
3, 10, 1,
1, 1, 1,
4, 4, 8,
4, 10
)
)
convert_word_to_score <- function(word) {
suppressMessages(str_to_lower(word) %>%
str_extract_all("[a-z]") %>%
unlist() %>%
tibble(letters = .) %>%
left_join(scores) %>%
pull(score) %>%
sum())
}
convert_word_to_score("one")
base_scores <- tribble(
~number, ~name,
0, "Zero",
1, "One",
2, "Two",
3, "Three",
4, "Four",
5, "Five",
6, "Six",
7, "Seven",
8, "Eight",
9, "Nine",
10, "Ten",
11, "Eleven",
12, "Twelve",
13, "Thirteen",
14, "Fourteen",
15, "Fifteen",
16, "Sixteen",
17, "Seventeen",
18, "Eighteen",
19, "Nineteen",
20, "Twenty"
) %>%
rowwise() %>%
mutate(score = convert_word_to_score(name))
filter(base_scores, number == score) %>%
knitr::kable()
base_scores %>%
ggplot(aes(x = number, y = score, colour=(number==score))) + geom_point() + geom_line(aes(x = 0:20, y = 0:20, colour=TRUE)) + theme + ggtitle("Twelve is the only number with its own Scrabble score", subtitle = "Line y=x added") + guides(colour=FALSE) + scale
base_scores %>%
filter(number > 0) %>% # Whoops, don't divide by zero.
mutate(relative_score = score / number) %>%
ggplot(aes(x = number, y = relative_score, colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour="0")) + labs(
title = "Small numbers score greater than themselves\n
but large numbers smaller.",
y = "Score/number"
) + guides(colour=FALSE) + scale
alias_scores <- read_csv(here::here("static", "data", "Wiki", "names_of_numbers.csv")) %>%
separate(3, as.character(1:100), ",") %>%
gather("key", "name", -Number) %>%
select(-key) %>%
drop_na() %>%
mutate(name = str_extract(name, "[a-zA-Z \\-]+")) %>% # Too many footnotes and references to countries that need dropping
drop_na() %>%
rowwise() %>%
mutate(score = convert_word_to_score(name)) %>%
arrange(Number)
knitr::kable(alias_scores, rownames = F)
alias_scores %>%
filter(Number==score) %>%
knitr::kable()
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_hline(yintercept = 1) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_hline(yintercept = 1) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:127,y=1,colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
?geom_hline()
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_hline(yintercept = 1, mapping = aes(colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:20,y=1,colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(data = data.frame(x=1:20,y=1), aes(x=1:20,y=1,colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(data = data.frame(x=1:60,y=1), aes(x=1:60,y=1,colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=1:60,y=1,colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=c(1:60, rep(60,67)),y=1,colour="1")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
alias_scores %>%
filter(Number > 0) %>%
mutate(relative_score = score / Number) %>%
ggplot(aes(x = Number, y = relative_score,
colour=as.factor(sign(relative_score-1)))) + geom_point() + theme + geom_line(aes(x=c(1:60, rep(60,67)),y=1,colour="0")) + labs(
title = "There are more winning numbers if we take other common name",
y = "Score/Number"
) + scale + guides(colour=FALSE)
blogdown::serve_site()
blogdown:::new_post_addin()
blogdown::serve_site()
blogdown::stop_server()
?blogdown::serve_site
blogdown::serve_site
blogdown:::serve_it
blogdown::serve_site()
getwd()
getwd()
setwd("~/bin/R/Open_Operational_Research")
getwd()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::stop_server()
blogdown::stop_server()
blogdown::stop_server()
blogdown::stop_server()
blogdown::serve_site()
blogdown::serve_site()
