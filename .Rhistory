set.seed(18081)
theme <- ggthemes::theme_few()
scale <- ggthemes::scale_colour_few()
powerlifting_data <- read_csv(here("static", "data", "Open Powerlifting", "openpowerlifting-2019-06-19.csv"))
powerlifting_data %>%
filter(Sex=="M", !is.na(AgeClass)) %>%
mutate(AgeClass = replace(AgeClass, AgeClass=="5-12", "05-12")) %>% #Cheap way to make them line up in order
select(Sex, AgeClass,
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0) %>% # Failed lifts are logged as negative
ggplot(aes(x=kg, y=AgeClass)) + geom_density_ridges2(aes(rel_min_height=0.005)) + facet_wrap(~lift) + theme_ridges()
powerlifting_data %>%
filter(Sex=="F", !is.na(AgeClass)) %>%
mutate(AgeClass = replace(AgeClass, AgeClass=="5-12", "05-12")) %>% #Cheap way to make them line up in order
select(Sex, AgeClass,
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0) %>% # Failed lifts are logged as negative
ggplot(aes(x=kg, y=AgeClass)) + geom_density_ridges2(aes(rel_min_height=0.005)) + facet_wrap(~lift) + theme_ridges()
powerlifting_data %>%
filter(Sex=="F", !is.na(AgeClass)) %>%
mutate(AgeClass = replace(AgeClass, AgeClass=="5-12", "05-12")) %>% #Cheap way to make them line up in order
select(Sex, AgeClass,
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0) %>% # Failed lifts are logged as negative
ggplot(aes(x=kg, y=AgeClass)) + geom_density_ridges2(aes(rel_min_height=0.005)) + facet_wrap(~lift, scale="free_x") + theme_ridges()
powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34")
comparison_data <- powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34") %>%
select(Sex, AgeClass,
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0)
comparison_data <- powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34") %>%
select(
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0)
comparison_data <- powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34") %>%
select(
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0)
comparison_data %>%
filter(lift=="Bench") %>%
arrange(kg)
comparison_data <- powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34") %>%
select(
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0)
comparison_data %>%
filter(lift=="Bench") %>%
arrange(kg) %>%
mutate(row = row_number()) %>%
mutate(percentage = row/max(row))
comparison_data <- powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34") %>%
select(
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0)
comparison_data %>%
filter(lift=="Bench") %>%
arrange(kg) %>%
mutate(row = row_number()) %>%
mutate(percentage = row/max(row)) %>%
filter(kg == 80)
comparison_data <- powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34") %>%
select(
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0)
comparison_data %>%
filter(lift=="Bench") %>%
arrange(kg) %>%
mutate(row = row_number()) %>%
mutate(percentage = row/max(row)) %>%
filter(kg == 80) %>%
summarise(from = min(percentage) * 100, to=max(percentage)*100)
comparison_data <- powerlifting_data %>%
filter(Sex=="M", AgeClass == "24-34") %>%
select(
Bench    = Best3BenchKg,
Squat    = Best3SquatKg,
Deadlift = Best3DeadliftKg) %>%
gather(lift, kg, Bench, Squat, Deadlift) %>% # Make long or 'tidy'
filter(!is.na(kg)) %>%
filter(kg>0)
lift_to_percentile <- function(lift_name, weight){
comparison_data %>%
filter(lift==lift_name) %>%
arrange(kg) %>%
mutate(row = row_number()) %>%
mutate(percentage = row/max(row)) %>%
filter(kg == weight) %>%
summarise(from = min(percentage) * 100, to=max(percentage)*100)
}
lift_to_percentile("Bench", 80)
lift_to_percentile("Deadlift", 145)
lift_to_percentile("Squat", 130)
powerlifting_data %>%
group_by(Name) %>%
summarise(squat_pr = max(Best3SquatKg), deadlift_pr = max(Best3DeadliftKg)) %>%
mutate(squat_to_deadlift = deadlift/squat) %>%
ggplot(aes(x=squat_to_deadlift)) + geom_density() + theme_ridges()
powerlifting_data %>%
group_by(Name) %>%
summarise(squat_pr = max(Best3SquatKg), deadlift_pr = max(Best3DeadliftKg)) %>%
mutate(squat_to_deadlift = deadlift_pr/squat_pr) %>%
ggplot(aes(x=squat_to_deadlift)) + geom_density() + theme_ridges()
?geom_density
powerlifting_data %>%
group_by(Name) %>%
summarise(squat_pr = max(Best3SquatKg), deadlift_pr = max(Best3DeadliftKg)) %>%
mutate(squat_to_deadlift = deadlift_pr/squat_pr) %>%
filter(squat_to_deadlift > 0) %>%
ggplot(aes(x=squat_to_deadlift)) + geom_density() + theme_ridges()
powerlifting_data %>%
group_by(Name) %>%
summarise(squat_pr = max(Best3SquatKg), deadlift_pr = max(Best3DeadliftKg)) %>%
mutate(squat_to_deadlift = deadlift_pr/squat_pr) %>%
filter(squat_to_deadlift > 0, squat_to_deadlift < 2.5) %>%
ggplot(aes(x=squat_to_deadlift)) + geom_density() + theme_ridges()
blogdown::serve_site(host="0.0.0.0")
blogdown::serve_site()
install.packages("exams")
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown::serve_site()
blogdown::serve_site()
blogdown::stop_server()
blogdown::stop_server()
blogdown::stop_server()
blogdown::serve_site()
lubridate::today()
as.integer(lubridate::today())
here()
here()
here::here()
here::here("..")
here::here("..", "analyse_fit")
here::here("..", "analyse_fito", "JR fito.csv")
read_csv(here::here("..", "analyse_fito", "JR fito.csv"))
library(tidyverse)
read_csv(here::here("..", "analyse_fito", "JR fito.csv"))
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
collapse = TRUE
)
library("tidyverse")
library("ggridges")
library("here")
set.seed(18150)
JR_fito_data <- read_csv(here("..", "analyse_fito", "JR fito.csv"))
View(JR_fito_data)
JR_fito_data %>%
top_n(-1, actiondate)
JR_fito_data %>%
top_n(-1, actiondate)
JR_fito_data[1,1]
JR_fito_data %>%
top_n(-1, actiondate)
blogdown::stop_server()
blogdown::stop_server()
blogdown::stop_server()
JR_fito_data %>%
top_n(-1, actiondate)
JR_fito_data %>%
group_by(name) %>%
summarise(points=sum(points)) %>%
arrange(-points)
blogdown::serve_site()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
head() %>%
knitr::kable()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
head(10) %>%
knitr::kable()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
top_n(10, points) %>%
arrange(-points) %>%
knitr::kable()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
ggplot(aes(x=name,y=points)) + geom_point()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
mutate(x=row_number()) %>%
ggplot(aes(x=x,y=points)) + geom_point()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
mutate(x=row_number()) %>%
ggplot(aes(x=x,y=points)) + geom_point() + scale_x_log10() + scale_y_log10()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
ggplot(aes(y=points,fill=name)) + geom_bar()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
ggplot(aes(y=points,fill=name)) + geom_col()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
ggplot(aes(y=points,fill=name,x="")) + geom_col()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
ggplot(aes(y=points,fill=name,x="")) + geom_col() + ggthemes::theme_few()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
ggplot(aes(y=points,fill=name,x="")) + geom_col() + govstyle::theme_gov()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
mutate(name = row_number()) %>%
ggplot(aes(y=points,fill=name,x="")) + geom_col() + govstyle::theme_gov()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
arrange(-points) %>%
mutate(name = as.character(row_number())) %>%
ggplot(aes(y=points,fill=name,x="")) + geom_col() + govstyle::theme_gov()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
top_n(-10, points) %>%
arrange(points) %>%
knitr::kable()
blogdown::stop_server()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
library("lubridate")
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
collapse = TRUE
)
library("tidyverse")
library("ggridges")
library("here")
library("lubridate")
set.seed(18150)
JR_fito_data <- read_csv(here("..", "analyse_fito", "JR fito.csv"))
JR_fito_data %>%
mutate(month=month(actiondate), year=year(actiondate)) %>%
group_by(month,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=month,y=year,fill=points)) + geom_point()
JR_fito_data %>%
mutate(month=month(actiondate), year=year(actiondate)) %>%
group_by(month,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=month,y=year,colour=points)) + geom_point()
JR_fito_data %>%
mutate(month=month(actiondate), year=year(actiondate)) %>%
group_by(month,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=month,y=year,fill=points)) + geom_tile()
JR_fito_data %>%
mutate(month=week(actiondate), year=year(actiondate)) %>%
group_by(month,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=month,y=year,fill=points)) + geom_tile()
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=points)) + geom_tile() + ggthemes::theme_few()
week(40)
week(today())
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=points)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019)
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=points)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Fitocracy XP by week")
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = distinct(actiondate)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=points)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week")
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = length(unique(actiondate)))) %>%
JR_fito_data %>%
group_by(actiondate) %>%
first() %>%
ungroup()
JR_fito_data %>%
group_by(actiondate) %>%
first()
JR_fito_data %>%
group_by(actiondate) %>%
head(1)
JR_fito_data %>%
select(actiondate) %>%
distinct()
JR_fito_data %>%
select(actiondate) %>%
distinct() %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=n)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week")
JR_fito_data %>%
select(actiondate) %>%
distinct() %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=n)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week") + scale_fill_discrete()
JR_fito_data %>%
select(actiondate) %>%
distinct() %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = paste(n())) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=n)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week")
JR_fito_data %>%
select(actiondate) %>%
distinct() %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = paste(n())) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=n)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week") + ggthemes::scale_fill_few()
JR_fito_data %>%
select(actiondate) %>%
distinct() %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=n)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week") + ggthemes::scale_fill_few()
JR_fito_data %>%
select(actiondate) %>%
distinct() %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=n)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week") + scale_fill_continuous(type = "viridis")
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=points)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Fitocracy XP by week") + scale_fill_continuous(type = "viridis")
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=log(points))) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Fitocracy XP by week") + scale_fill_continuous(type = "viridis")
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=points)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Fitocracy XP by week") + scale_fill_continuous(type = "viridis")
extract_kg <- function(string){ # Plucks the kg measurement out of the dataset
str_extract(string, "[0-9]+ kg") %>%
str_extract("[0-9]+") %>% #I know this could be rewritten as 1 regex, but I find this easier to read.
as.numeric()
}
extract_PRs <- function(data, activity){
data %>%
filter(name==activity) %>%
arrange(actiondate) %>%
mutate(kg = extract_kg(string_metric)) %>%
mutate(PR = cummax(kg)) %>%
filter(kg==PR)
}
extract_PRs(JR_fito_data, "Barbell Bench Press")
extract_PRs(JR_fito_data, "Barbell Bench Press") %>%
ggplot(aes(x=actiondate,y=kg)) + geom_line()
extract_PRs(JR_fito_data, "Barbell Bench Press") %>%
ggplot(aes(x=actiondate,y=kg)) + geom_point()
extract_PRs(JR_fito_data, "Barbell Bench Press") %>%
ggplot(aes(x=actiondate,y=kg)) + geom_line()
extract_PRs(JR_fito_data, "Barbell Bench Press") %>%
plotly::plot_ly(x=~actiondate,y=~kg) %>% plotly::add_lines()
?layout
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines() %>%
layout(list(title=paste(activity, "PRs")))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
library(plotly)
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines() %>%
layout(ltitle=paste(activity, "PRs"))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines() %>%
layout(title=paste(activity, "PRs"))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines(line=list(type="hv")) %>%
add_markers()
layout(title=paste(activity, "PRs"))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines(line=list(shape="hv")) %>%
add_markers()
layout(title=paste(activity, "PRs"))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines(line=list(shape="hv")) %>%
add_markers() %>%
layout(title=paste(activity, "PRs"))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines(line=list(shape="hv")) %>%
layout(title=paste(activity, "PRs"))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
