mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "month"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + theme(legend.position = "none") + ggthemes::theme_few() + ggthemes::scale_fill_few()
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + ggthemes::scale_fill_few() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + scale_fill_viridis_d() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(desc(volume)) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + scale_fill_viridis_d() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(desc(volume)) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma())
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma)
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_log10(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
filter(volume>0) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_log10(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted") + scale_fill_brewer()
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted") + scale_fill_ordinal()
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted") + scale_fill_viridis_d()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site(host="0.0.0.0")
blogdown::stop_server()
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
collapse = TRUE
)
library("tidyverse")
library("lubridate")
library("plotly")
library("leaflet")
set.seed(18150)
JR_fito_data <- read_csv(here::here("..", "analyse_fito", "JR fito.csv"))
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
top_n(10, points) %>%
arrange(-points) %>%
knitr::kable()
JR_fito_data %>%
group_by(name) %>%
summarise(points = sum(points)) %>%
top_n(-10, points) %>%
arrange(points) %>%
knitr::kable()
JR_fito_data %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(points=sum(points)) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=points)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Fitocracy XP by week") + scale_fill_continuous(type = "viridis")
JR_fito_data %>%
select(actiondate) %>%
distinct() %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
group_by(week,year) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(x=week,y=year,fill=n)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Number of workouts per week") + scale_fill_continuous(type = "viridis")
## A couple of helper functions.
extract_kg <- function(string){ # Plucks the kg measurement out of the dataset
str_extract(string, "[0-9]+\\.?[0-9]* kg") %>%
str_remove("kg") %>% #I know this could be rewritten as 1 regex, but I find this easier to read.
as.numeric()
}
extract_PRs <- function(data, activity){
data %>%
filter(name==activity) %>%
arrange(actiondate) %>%
mutate(kg = extract_kg(string_metric)) %>%
mutate(PR = cummax(kg)) %>% # which kg are bigger than any before?
filter(kg==PR) # Keeping only entries that are PRs
}
plot_ly_PR <- function(data, activity){
extract_PRs(data, activity) %>%
plot_ly(x=~actiondate, y=~kg) %>%
add_lines(line=list(shape="hv")) %>%
layout(title=paste(activity, "PRs"))
}
plot_ly_PR(JR_fito_data, "Barbell Bench Press")
plot_ly_PR(JR_fito_data, "Standing Barbell Shoulder Press (OHP)")
plot_ly_PR(JR_fito_data, "Barbell Deadlift")
plot_ly_PR(JR_fito_data, "Barbell Squat")
## A couple of helper functions.
extract_km <- function(string){ # Plucks the kg measurement out of the dataset
string <- str_extract(string, "[0-9]+\\.?[0-9]* k?m")
meters <- !str_detect(string, "k")
result <-  str_remove(string, "k?m") %>% #I know this could be rewritten as 1 regex, but I find this easier to read.
as.numeric()
if_else(meters, result / 1000, result)
}
extract_cumulative_distance <- function(data, activity){
data %>%
filter(name==activity) %>%
arrange(actiondate) %>%
mutate(km = extract_km(string_metric)) %>%
mutate(cumulative_km = cumsum(km))
}
ggplot_dist <- function(data, activity){
extract_cumulative_distance(data, activity) %>%
ggplot(aes(x=actiondate,y=cumulative_km)) + geom_line() +
ggthemes::theme_few()  +
ggtitle(paste("Total Distance", activity))
}
ggplot_dist(JR_fito_data, "Cycling")
ggplot_dist(JR_fito_data, "Running")
ggplot_dist(JR_fito_data, "Swimming")
cycling_total_km <- extract_cumulative_distance(JR_fito_data, "Cycling") %>%
top_n(1) %>%
pull(cumulative_km)
leaflet() %>%
addTiles() %>%
addCircles(lat = 53.798250, lng = -1.532112, radius = 1000*cycling_total_km)
volume <- function(string){
kg <- str_extract(string, "[0-9]+\\.?[0-9]* kg") %>%
str_remove("kg") %>%
as.numeric()
reps <- str_extract(string, "[0-9]+\\.?[0-9]* reps") %>%
str_remove("reps") %>%
as.numeric()
kg * reps
}
JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
group_by( name) %>%
summarise(volume=sum(volume)) %>%
ungroup() %>%
top_n(10, volume) %>%
arrange(desc(volume)) %>%
mutate(volume = scales::comma(volume)) %>%
knitr::kable()
volume_graph <- function(data, activity){
data %>%
filter(name==activity) %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
arrange(actiondate) %>%
mutate(volume=cumsum(volume)) %>%
ggplot(aes(x=actiondate,y=volume)) + geom_line() + ggthemes::theme_few() +
ggtitle(str_c("Total Volume Over Time: ", activity)) + ylab("Volume (kg-reps)") + scale_y_continuous(labels = scales::comma)
}
volume_graph(JR_fito_data, "Barbell Deadlift")
volume_graph(JR_fito_data, "Barbell Squat")
volume_graph(JR_fito_data, "Ring Pull-Up")
cumulative_volume <- JR_fito_data %>%
mutate(volume = volume(string_metric)) %>%
filter(!is.na(volume)) %>%
mutate(actiondate=floor_date(actiondate, "week"))
missing_values <- cross_df(list(
name=unique(cumulative_volume$name),
actiondate=as.character(unique(cumulative_volume$actiondate))
)) %>%
mutate(actiondate=ymd(actiondate)) %>%
anti_join(cumulative_volume) %>%
mutate(volume=0)
bind_rows(cumulative_volume, missing_values) %>%
group_by(name, actiondate) %>%
summarise(volume = sum(volume)) %>%
arrange(actiondate) %>%
mutate(volume = cumsum(volume)) %>%
ungroup() %>%
arrange(volume) %>%
mutate(name=as_factor(name)) %>%
ggplot(aes(x=actiondate, y=volume, fill=name)) + geom_area() + ggthemes::theme_few() + theme(legend.position = "none") + scale_y_continuous(labels = scales::comma) +
ggtitle("Cumulative volume, activity highlighted") + scale_fill_viridis_d()
cumulative_volume %>%
group_by(actiondate) %>%
summarise(volume=sum(volume)) %>%
ggplot(aes(x=week,y=year,fill=volume)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Volume by week") + scale_fill_continuous(type = "viridis")
cumulative_volume %>%
group_by(actiondate) %>%
summarise(volume=sum(volume))
cumulative_volume %>%
group_by(actiondate) %>%
summarise(volume=sum(volume)) %>%
mutate(week=week(actiondate), year=year(actiondate)) %>%
ggplot(aes(x=week,y=year,fill=volume)) + geom_tile() + ggthemes::theme_few() + scale_y_continuous(breaks = 2012:2019) + ggtitle("Volume by week") + scale_fill_continuous(type = "viridis")
cumulative_volume %>%
group_by(actiondate) %>%
summarise(volume=sum(volume)) %>%
top_n(1)
blogdown::serve_site(host="0.0.0.0")
blogdown::stop_server()
